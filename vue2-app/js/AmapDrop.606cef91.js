(window["webpackJsonp_vue2-app"]=window["webpackJsonp_vue2-app"]||[]).push([["AmapDrop"],{"4a5e":function(t,n,e){"use strict";e("a657")},"6e85":function(t,n,e){var i=e("e510"),a=e("e7ef");i({global:!0,forced:parseFloat!=a},{parseFloat:a})},a657:function(t,n,e){},e64a:function(t,n,e){"use strict";e.r(n);var i=function(){var t=this;t._self._c;return t._m(0)},a=[function(){var t=this,n=t._self._c;return n("div",{attrs:{id:"map"}},[n("div",{attrs:{id:"container"}}),n("div",{attrs:{id:"loading"}},[t._v("加载中...")])])}],o=e("8fa8"),r=e("f82f"),c=(e("6e85"),e("faea"),e("1b5b"),e("1ef9"),e("5fda"),e("01e5"),e("5445"),null),l={name:"AmapDrop",title:"高德地图下钻",data:function(){return{}},mounted:function(){var t=this;this.$nextTick((function(){t.init()}))},destroyed:function(){c=null},methods:{init:function(){c=new AMap.Map("container",{resizeEnable:!1,center:[106.889724,35.086912],zoom:4});var t=document.getElementById("loading"),n=[],e=[],i=["#f04864","#facc14","#2fc25b","#1890ff","#8543e0"];function a(){e.length>0&&c.remove(e),n.length>0&&c.remove(n),n=[],e=[]}function l(t,n){return Math.floor(Math.random()*(n-t))+t}function s(t){try{for(var n=t.length,e=0,i=0,a=0,o=0;o<t.length;o++)if(""!=t[o]){var r=t[o],c=void 0,s=void 0,d=void 0,f=void 0,u=void 0;s=parseFloat(r[0])*Math.PI/180,c=parseFloat(r[1])*Math.PI/180,d=Math.cos(c)*Math.cos(s),f=Math.cos(c)*Math.sin(s),u=Math.sin(c),e+=d,i+=f,a+=u}e/=n,i/=n,a/=n;var v=Math.atan2(i,e),h=Math.atan2(a,Math.sqrt(e*e+i*i)),p=.01*l(2,12),m=.01*l(3,12);return[180*v/Math.PI+p,180*h/Math.PI+m]}catch(b){console.warn("获取中心坐标失败"),console.log(b)}}var d={},f=function(t,e){var i=new AMap.Polygon({strokeWeight:2,path:t,fillOpacity:.4,clickable:!1,fillColor:e,strokeColor:e,lineJoin:"round"});n.push(i)},u=function(t){var n=t.name,i=void 0===n?"":n,a=t.count,o=void 0===a?0:a,r=t.center,s=void 0===r?[]:r,d=t.color,f=void 0===d?"#111":d,u=new AMap.Marker({content:"<div class='area-map-marker' style='color: ".concat(f,"'>\n                      <div class='area-map-marker__title' style='font-weight: bold;'>").concat(i,"</div>\n                      <div class='area-map-marker__count'>").concat(o||l(100,1e4),"</div>\n                      <div class='area-map-marker__title'>").concat(t.children?"我可以下钻":"","</div>\n                    </div>"),anchor:"center",draggable:!1,cursor:"pointer",position:s,extData:t,zIndex:1e3});e.push(u),t.children&&u.on("mousedown",(function(t){v(t)})),u.setMap(c)},v=function(t){var n=t.target.De.extData,e=n.level,i=n.id;p(i,e+1)},h=function(n){var e=n.id,i=n.level;return console.log(e,i),new Promise((function(n,a){if(!(i>4))return 3===i&&2!=e?(t.style.visibility="hidden",!1):void fetch("data/areaList-".concat(i,".json")).then((function(t){return t.json()})).then((function(t){n(t)}))["catch"]((function(n){a(n),t.style.visibility="hidden"}));t.style.visibility="hidden"}))},p=function(e){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t.style.visibility="visible",h({id:e,level:l}).then((function(e){a(),e.map((function(t,n){var e=[];if(t.areaIdList.map((function(t){if(d[t]){var a=JSON.parse(JSON.stringify(d[t]));a.map((function(t){e=[].concat(Object(r["a"])(e),Object(r["a"])(t)),f(JSON.parse(JSON.stringify(t)),i[n%5])}))}})),e.length>0){var a=s(e);u(Object(o["a"])(Object(o["a"])({},t),{},{center:a,color:i[n%5]}))}})),t.style.visibility="hidden",c.add(n),c.setFitView(n)}),(function(){t.style.visibility="hidden"}))},m=function(){return t.style.visibility="visible",new Promise((function(n,e){fetch("data/areaPath.json").then((function(t){return t.json()})).then((function(t){d=t,p(),n(t)}))["catch"]((function(n){e(n),t.style.visibility="hidden"}))}))};m()}}},s=l,d=(e("4a5e"),e("0abc")),f=Object(d["a"])(s,i,a,!1,null,null,null);n["default"]=f.exports},e7ef:function(t,n,e){var i=e("dcf5"),a=e("2178"),o=e("d501"),r=e("c061"),c=e("0c89").trim,l=e("51a5"),s=o("".charAt),d=i.parseFloat,f=i.Symbol,u=f&&f.iterator,v=1/d(l+"-0")!==-1/0||u&&!a((function(){d(Object(u))}));t.exports=v?function(t){var n=c(r(t)),e=d(n);return 0===e&&"-"==s(n,0)?-0:e}:d}}]);
//# sourceMappingURL=AmapDrop.606cef91.js.map